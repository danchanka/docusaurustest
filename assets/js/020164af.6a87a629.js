(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{76:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return r})),a.d(t,"metadata",(function(){return l})),a.d(t,"toc",(function(){return c})),a.d(t,"default",(function(){return p}));var o=a(3),n=a(7),s=(a(0),a(424)),i=a(57),r={title:"How-to: Registers"},l={unversionedId:"How-to_Registers",id:"How-to_Registers",isDocsHomePage:!1,title:"How-to: Registers",description:"Accumulation ledger",source:"@site/docs/How-to_Registers.md",slug:"/How-to_Registers",permalink:"/docusaurustest/docs/How-to_Registers",editUrl:"https://github.com/danchanka/docusaurustest/edit/master/docs/How-to_Registers.md",version:"current",sidebar:"docs",previous:{title:"How-to: Working with documents",permalink:"/docusaurustest/docs/How-to_Working_with_documents"},next:{title:"How-to: Numbering",permalink:"/docusaurustest/docs/How-to_Numbering"}},c=[{value:"Accumulation ledger",id:"accumulation-ledger",children:[]},{value:"Information ledger",id:"information-ledger",children:[]}],d={toc:c};function p(e){var t=e.components,a=Object(n.a)(e,["components"]);return Object(s.b)("wrapper",Object(o.a)({},d,a,{components:t,mdxType:"MDXLayout"}),Object(s.b)("h3",{id:"accumulation-ledger"},"Accumulation ledger"),Object(s.b)("p",null,"Let's assume we need to implement the logic for calculating the SKU balances."),Object(s.b)(i.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseLedger&block=skumaster",mdxType:"CodeSample"}),Object(s.b)("p",null,"Theoretically we could just create a ",Object(s.b)("a",{parentName:"p",href:"/docusaurustest/docs/Properties"},"property")," that would sum up all incomings and subtract all outgoings, with all operations set explicitly. The weakness of this approach is that whenever a new operation is added, it needs to be added to the formula for calculating the balance. In addition, it will be difficult to build a form with a list of all the operations that can affect the balance for a specific SKU and warehouse. ",Object(s.b)("a",{parentName:"p",href:"/docusaurustest/docs/Modularity"},"Modularity")," will also be violated, because the module in which the balance property is declared will depend on all modules containing operations that affect it."),Object(s.b)("p",null,"To give the system efficient ",Object(s.b)("a",{parentName:"p",href:"/docusaurustest/docs/Extensions"},"extensibility"),", it is best to implement this kind of functionality using ",Object(s.b)("em",{parentName:"p"},"ledgers"),". To do this, we introduce an abstract class ",Object(s.b)("strong",{parentName:"p"},"SKULedger"),". One instance of the class will reflect a single change in the balance by a given amount (positive or negative) for one SKU in one warehouse. Abstract properties are set for it, which need to be defined when the class is implemented."),Object(s.b)("div",{className:"admonition admonition-info alert alert--info"},Object(s.b)("div",{parentName:"div",className:"admonition-heading"},Object(s.b)("h5",{parentName:"div"},Object(s.b)("span",{parentName:"h5",className:"admonition-icon"},Object(s.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(s.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),Object(s.b)("div",{parentName:"div",className:"admonition-content"},Object(s.b)("p",{parentName:"div"},"All ledgers can have an arbitrary number and type of measurements. In this example they are the SKU and the Warehouse."))),Object(s.b)(i.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseLedger&block=skuledger",mdxType:"CodeSample"}),Object(s.b)("p",null,"The current balance and the balance for a certain time period are calculated only from the properties of the ",Object(s.b)("strong",{parentName:"p"},"SKULedger")," class without reference to specific operations. This code can and must be declared in a separate module. Modules containing specific operations will use and extend this class."),Object(s.b)("p",null,"For example, let's look at one operation: ",Object(s.b)("em",{parentName:"p"},"Stock receipt.")),Object(s.b)(i.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseLedger&block=skureceipt",mdxType:"CodeSample"}),Object(s.b)("p",null,'To "post" it into the ledger, we need to ',Object(s.b)("a",{parentName:"p",href:"/docusaurustest/docs/Class_extension"},"extend the class")," ",Object(s.b)("strong",{parentName:"p"},"SKULedger")," with a ",Object(s.b)("strong",{parentName:"p"},"ReceiptDetail")," class for stock receipt. We also need to ",Object(s.b)("a",{parentName:"p",href:"/docusaurustest/docs/Property_extension"},"extend the properties")," of the ledger."),Object(s.b)(i.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseLedger&block=skureceiptimplement",mdxType:"CodeSample"}),Object(s.b)("p",null,"Let's look at a more complex case, when we have a document recording transfer from one warehouse to another."),Object(s.b)(i.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseLedger&block=skutransfer",mdxType:"CodeSample"}),Object(s.b)("p",null,'In this case, the data from the document must be "posted" into the ledger twice. By analogy with stock receipt, we will post the line into the ledger as an outgoing operation with a negative value.'),Object(s.b)(i.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseLedger&block=skutransferimplement",mdxType:"CodeSample"}),Object(s.b)("p",null,"To post it into the ledger for the warehouse where the SKUs are being transferred to, we use object ",Object(s.b)("a",{parentName:"p",href:"/docusaurustest/docs/Aggregations"},"aggregation"),'. The line in the transfer document will generate an object, which in turn will be "posted" into the ledger.'),Object(s.b)(i.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseLedger&block=skutransferaggregation",mdxType:"CodeSample"}),Object(s.b)("p",null,"The ledger object will only be created when the transfer document has been posted. Therefore, in this case the ",Object(s.b)("strong",{parentName:"p"},"posted")," property will always equal ",Object(s.b)("strong",{parentName:"p"},"TRUE"),"."),Object(s.b)("p",null,"It should be noted that documents with one warehouse can also be posted into the ledger using aggregation. The aggregation scheme is more flexible but requires the creation of additional objects in the system, which may be worse from a performance perspective."),Object(s.b)("h3",{id:"information-ledger"},"Information ledger"),Object(s.b)("p",null,"The ",Object(s.b)("em",{parentName:"p"},"information ledger")," technique makes it possible to implement the logic of changing a certain indicator over time in a flexible way. Unlike the inventory ledger, it calculates not the sum of an indicator but its latest value over a certain period of time."),Object(s.b)("p",null,"To implement this technique we introduce an abstract class ",Object(s.b)("strong",{parentName:"p"},"PriceLedger"),". Its instance reflects a single price change for one SKU and one warehouse at a certain time."),Object(s.b)(i.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseLedger&block=priceledger",mdxType:"CodeSample"}),Object(s.b)("p",null,"As a result, we get properties giving the price by SKU and warehouse for the date/time, the latest price, and also the latest price for that SKU for all warehouses."),Object(s.b)("p",null,"Documents are posted into the information ledger the same way they are posted into the inventory ledger."),Object(s.b)(i.CodeSample,{url:"https://documentation.lsfusion.org/sample?file=UseCaseLedger&block=pricereceiptimplement",mdxType:"CodeSample"}),Object(s.b)("p",null,"In this case the signature of the abstract property needs to be specified explicitly, because there can be several of them with the same name and namespace (properties are named in just the same way for class ",Object(s.b)("strong",{parentName:"p"},"SKULedger"),")."))}p.isMDXComponent=!0}}]);