<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/docusaurustest/blog/rss.xml" title="lsfusion documentation Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docusaurustest/blog/atom.xml" title="lsfusion documentation Blog Atom Feed"><title data-react-helmet="true">lsFusionAccess_from_an_external_system | lsfusion documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="lsFusionAccess_from_an_external_system | lsfusion documentation"><meta data-react-helmet="true" name="description" content="lsFusionAccess from an external system"><meta data-react-helmet="true" property="og:description" content="lsFusionAccess from an external system"><meta data-react-helmet="true" property="og:url" content="https://danchanka.github.io/docusaurustest/docs/LSFUS/lsFusionAccess_from_an_external_system"><link data-react-helmet="true" rel="shortcut icon" href="/docusaurustest/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://danchanka.github.io/docusaurustest/docs/LSFUS/lsFusionAccess_from_an_external_system"><link rel="stylesheet" href="/docusaurustest/styles.157dcc77.css">
<link rel="preload" href="/docusaurustest/styles.484185aa.js" as="script">
<link rel="preload" href="/docusaurustest/runtime~main.4775eaa0.js" as="script">
<link rel="preload" href="/docusaurustest/main.7eadfc7f.js" as="script">
<link rel="preload" href="/docusaurustest/1.15ad1152.js" as="script">
<link rel="preload" href="/docusaurustest/2.388c98e9.js" as="script">
<link rel="preload" href="/docusaurustest/354.8fc443a5.js" as="script">
<link rel="preload" href="/docusaurustest/355.8d0f0209.js" as="script">
<link rel="preload" href="/docusaurustest/f976f453.a4a359a4.js" as="script">
<link rel="preload" href="/docusaurustest/17896441.e3533d34.js" as="script">
<link rel="preload" href="/docusaurustest/64f5043a.b40b6bb6.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/docusaurustest/"><img src="/docusaurustest/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/docusaurustest/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">lsfusion</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docusaurustest/docs/">Docs</a><a class="navbar__item navbar__link" href="/docusaurustest/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/danchanka/docusaurustest" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/docusaurustest/"><img src="/docusaurustest/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/docusaurustest/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">lsfusion</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docusaurustest/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/docusaurustest/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/danchanka/docusaurustest" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">lsFusionAccess_from_an_external_system</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="lsfusionaccess-from-an-external-system"></a>lsFusionAccess from an external system<a class="hash-link" href="#lsfusionaccess-from-an-external-system" title="Direct link to heading">#</a></h1><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="access-from-an-external-system"></a>Access from an external system<a class="hash-link" href="#access-from-an-external-system" title="Direct link to heading">#</a></h1><p>The platform allows external systemsÂ Â  to access an lsFusion-based system using various network protocols. The interface of such interaction is a call for an action with specified parameters and, if necessary, the return of certain property values (without parameters) as Â <em>results</em>. It is assumed that all parameter and result objects are objects of <a href="/docusaurustest/docs/LSFUS/lsFusionBuilt-in_classes">built-in classes</a>.</p><p><strong>Defining an action</strong></p><p>An action being called can be defined in one of the three ways:</p><ul><li>EXEC â€“ the name of the action is specified.</li><li>EVAL â€“ code in the lsFusion language is specified. It is assumed that this code contains a declaration of an action named <strong>run</strong>. This is the action that will be called.</li><li>EVAL ACTION â€“ action code in the lsFusion language is specified. To access a parameter, the special character $ and the parameter number (starting from 1) are used.</li></ul><p><strong>Protocols</strong></p><p>The platform currently supports the following network protocols:</p><ul><li><strong>HTTP</strong></li></ul><p>Communication over this protocol is supported both for an application server on port 7651, as well as a web server (if any) on the same port, that has a web client installed.</p><p>The URL format, depending on the method of <a href="#Accessfromanexternalsystem-actiontype">action definition</a>, looks as follows:</p><ul><li>EXEC - http://server address:port/exec?action=&lt;action name&gt;. The &quot;action&quot; parameter must always be specified.</li><li>EVAL - http://server address:port/eval?script=&lt;code&gt;. If the &quot;script&quot; parameter is not specified, it is assumed that the code is passed in the first BODY parameter.</li><li>EVAL ACTION â€“ http://server address:port/eval/action?script=&lt;action code&gt;.Â If the &quot;script&quot; parameter is not specified, it is assumed that the code is passed in the first BODY parameter.</li></ul><p><em>Parameters</em></p><p>Parameters can be passed both in the request string (by appending constructs like &amp;p=&lt;parameter value&gt; to the end of the string), as well as in the request body (BODY). It is assumed that URL parameters are substituted (in the order of their appearance in the request) for the executed action before BODY parameters.</p><p>When processing BODY parameters, parameters with the content type from the followingÂ <a href="https://github.com/lsfusion/platform/blob/master/api/src/main/resources/MIMETypes.properties" target="_blank" rel="noopener noreferrer">table</a> are considered files and are passed to the action parameters as objects of the file class ( <strong>FILE</strong> , *<strong>*PDFFILE**</strong> Â , etc.). During this process, the corresponding fileÂ extension is taken from the table mentioned above. If a particular content type is not found in the table, but it starts with &quot;application&quot;, the parameter is still considered a file, and the file extension is taken from the right part of the contentÂ type (for example, it will be &quot;abc&quot; for the &quot;application/abc&quot; content type). Parameters with the application/null content type are considered to be equal to <strong>NULL</strong>.</p><p>BODY parameters with types of content different from the ones mentioned above are considered strings and are automatically converted into parameter classes of the called action upon being called. Empty strings are converted into <strong>NULL</strong>.</p><p><a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields" target="_blank" rel="noopener noreferrer">Headers</a>Â of an executed request are automatically saved to the <strong>System.headers[TEXT]</strong> property. The name of the header is written to the only parameter of this property, and the value of the header is written to the property&#x27;s value.</p><p><em>Results</em></p><p>Properties whose values must be returned as the result are passed in the request string by adding strings like &amp;return=&lt;property name&gt; to its end. It is assumed that the values of specified properties are returned in the order of their appearance in the request string. By default, if no result properties are specified, the resulting property is the first one with a non-<strong>NULL</strong>Â value from the followingÂ <a href="/docusaurustest/docs/LSFUS/Built-in-classes_2031657.html#Built-inclasses-export">list</a>.Â </p><p>If the result of a request is a file (<strong>FILE</strong>, <strong>PDFFILE</strong>, etc.), the response <a href="https://en.wikipedia.org/wiki/Media_type" target="_blank" rel="noopener noreferrer">content type</a>Â , depending on the file extension,Â is determined in accordance with the following <a href="https://github.com/lsfusion/platform/blob/master/api/src/main/resources/MIMETypes.properties" target="_blank" rel="noopener noreferrer">table</a>. If the file extension is not found in this table, the content type is setÂ to application/&lt;fileÂ extension&gt;.</p><p>The file extension in this case is determined automatically, similarlyÂ to theÂ <a href="/docusaurustest/docs/LSFUS/WRITE-operator_34439654.html#WRITEoperator-id-%D0%9E%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80WRITE-extension"><strong>WRITE</strong>Â operator</a>.</p><p>In all of the three cases above, if the result value is <strong>NULL</strong>, a null string (for example, application/null) is substituted for the file extension in the content type, and an empty string is returned as the response itself.</p><p>Request results different from files are converted into strings and are passed as a text/plain content type. <strong>NULL</strong> values are returned as empty strings.</p><p>The values of theÂ <strong>System.headersTo[TEXT]</strong> property are automatically written to theÂ <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields" target="_blank" rel="noopener noreferrer">headers</a>Â of the request result. So, the header name is read from the only parameter of this property, and the header value is read from the property value.</p><p><em>Several </em>results/Â <em>parametersÂ </em>in BODY**</p><p>If the type of request BODY is multipart/* or application/x-www-form-urlencoded, it will be split into parts, and each part will be considered a separate request parameter. In this case, the order of these parameters is equal to the order in corresponding parts of the request BODY.</p><p>At the same time, if the number of results being returned is more than one, then the following happens:</p><ul><li>If the request has a returnmultitype=bodyurl parameter, the response content type on transmissionÂ is set to application/x-www-form-urlencoded and the results are encoded as if they were <a href="#Accessfromanexternalsystem-url">passed in the request string</a>.</li><li>Otherwise, the response content type during transmission is set to multipart/mixed, and the results are passed as internal parts of this response.Â </li></ul><p>Note that the processing of parameters and request results is largely similar to their processing during <a href="/docusaurustest/docs/LSFUS/lsFusionAccess_to_an_external_system_EXTERNAL_">access to an external system</a> over the HTTP protocol (in this case, parameters are processed as results and vice versa, results are processed as parameters).</p><p><em>Stateful API</em></p><p>The API described above is a REST API. Accordingly, theÂ <a href="/docusaurustest/docs/LSFUS/lsFusionChange_sessions">change session</a>Â is created when a call is initiated, and closes immediately after the call ends. However, there are situations where such behavior is undesirable, and you need to accumulate changes for a certain period of time (for example, while the user is inputting data), which means that the session must be saved and handed over between sessions. In order to do this, you can add a string of the following format to the end of the query string: &amp;session=&lt;session ID&gt;, where &lt;session ID&gt; is any non-empty string. In this case, the session will not be closed after the call, but will be associated with a previously passed ID, so that all subsequent calls with this ID will be executed in this session. In order to close a session (after the end of a call), you need to add the _close postfix (for example,&amp;session=0_close) to its ID in the request string.</p><p>Since cookie files are implicitly used for working with HTTP sessions, it is important not to forget to save / pass cookies between stateful http calls (this, however, is typically done automatically by a browser, the HttpClient in Java, etc.)</p><p>The current implementation of the platform assumes that if sessions are used, the elements of the system (for example, local properties) created in the current call are deleted â€” that is, they are not visible in subsequent calls.</p><p><em>Authentication</em></p><p>When executing an http request, it is often necessary to identify the user on whose behalf the specified action will be executed. At the moment, two types of authentication are supported by the platform:</p><ul><li><a href="https://en.wikipedia.org/wiki/Basic_access_authentication" target="_blank" rel="noopener noreferrer">Basic identification</a> - the user name and password are passed in an encoded form in the &quot;Authorization: Basic &lt;credentials&gt;&quot;heading.</li><li>Token-based authentication consists of two stages:<ul><li>At the first stage, you need to execute the Â <strong>Authentication.getAuthToken[]</strong> action with basic authentication. The result of this action will be an authentication token with a fixed lifetime (one day <a href="/docusaurustest/docs/LSFUS/Working-parameters_60555468.html#Workingparameters-authTokenExpiration">by default</a>). An example of a request: Â <a href="http://localhost/exec?action=getAuthToken." target="_blank" rel="noopener noreferrer">http://localhost/exec?action=getAuthToken.</a></li><li>The token you receive can be used for authentication during its lifetime by passing it in the &quot;Authorization: Bearer &lt;token&gt;&quot; header (similarly to JWT which is used in the current implementation of the platform for generating authentication tokens).</li></ul></li></ul><p><em>Form API</em></p><p>Apart from executing actions, the platform also supports an APIÂ (similar to JSON API) for working with <a href="/docusaurustest/docs/LSFUS/lsFusionForms">forms</a>, or specifically, their <a href="/docusaurustest/docs/LSFUS/lsFusionInteractive_view">interactive views</a>. Since it&#x27;s a stateful API designed for the asynchronous mode (which means that the HTTPS interface itself has a number of system parameters, such as a request index, index of the latest received response, etc.), it&#x27;s easier to use this API with the help of special libraries for specific languages/platforms that you want to integrate with:</p><ul><li><strong>JavaScript</strong></li></ul><p>The JavaScript library is available in the central npm-repository under the name Â <a href="https://www.npmjs.com/~lsfusion" target="_blank" rel="noopener noreferrer">@lsfusion/core</a>.</p><p>The key concept in this API is the concept of <em>state</em>. A state is a JS object with a structure corresponding to form elements in the following way:</p><ul><li><a href="/docusaurustest/docs/LSFUS/Form-structure_1573069.html#Formstructure-objects">An object group</a> corresponds to a JS object that is stored in the js field of the state object. The name of the field matches the name of the object group. Each JS object from the object group, in turn, stores an array of JS objects (with <a href="/docusaurustest/docs/LSFUS/Form-structure_1573069.html#Formstructure-filters">filters</a> and <a href="/docusaurustest/docs/LSFUS/Form-structure_1573069.html#Formstructure-sort">orders</a> taken into account) in the <strong>list</strong> field. The JS object of the object group corresponds to the <a href="/docusaurustest/docs/LSFUS/Form-structure_1573069.html#Formstructure-currentObject">current</a> object collection. Also, each JS object of an array (including the JS object of the object group) in the <strong>value</strong> field stores the value of objects â€“ only values if there is just one object in the object group or, if there are multiple objects, a JS object with fields whose names are equal to object names and values are equal to object values.</li><li><a href="/docusaurustest/docs/LSFUS/lsFusionProperties">Properties</a> correspond to a value stored in a field (the name of the field is equal to the property name) of a JS object which is determined in the following way depending on the existence of parameters andÂ <a href="/docusaurustest/docs/LSFUS/Interactive-view_1573071.html#Interactiveview-property">its view</a>:<ul><li>A property has parameters:<ul><li>The property view is equal to <strong>GRID</strong> of each JS object in the <strong>list</strong> array of the JS object of this property&#x27;s <a href="/docusaurustest/docs/LSFUS/Form-structure_1573069.html#Formstructure-drawgroup">display group</a>.</li><li>The property&#x27;s view is equal to <strong>PANEL</strong>, <strong>TOOLBAR</strong>Â  of the JS objectÂ of this property&#x27;sÂ display group</li></ul></li><li>A property has no parameters - of a JS state object.</li></ul></li></ul><p>The task of the library is to automatically keep this state described above up to date, both during form creation and during its subsequent modification (this behavior is often called reactivity).</p><p>The library exports the following functions:</p><ul><li>create - creates a new form. Parameters:<ol><li>setState - a state change request function. This function is supposed to take a single parameter â€“ a state change function (which, in turn, has just one parameter, the previous state, and outputs the next state as the result) and as a result of execution add this function to the state change queue (or, for example, apply it right away depending on the implementation of the view logic). This state management logic is fully identical to the state management logic in React and, as a rule, if used inside a React component, the setState parameter is passed as updateState =&gt; this.setState(updateState).</li><li>baseUrl - the URL of the lsFusion web server - a string, for exampleÂ &#x27;<a href="https://demo.lsfusion.org/hockeystats&#x27;" target="_blank" rel="noopener noreferrer">https://demo.lsfusion.org/hockeystats&#x27;</a>.</li><li>formData - an object describing the form. Must contain either a name field with the name of the form (for example {name: &quot;MainForm&quot;}) or a script field with the form code (for example, script:&quot;OBJECTS i = Invoice PROPERTIES (i) date, stock&quot;)</li></ol></li><li>change - changes the form data. Parameters:<ol><li>setState - a state change request function.</li><li>changes - a JS object containing what exactly needs to be changed. The structure of a JS change object is the same as that of the JS state object, except that a JS object of an object group does not have/is not supposed to have a <strong>list</strong> field â€“ that is, all changes are supposed to be made for current object collection. However, if necessary, the value can be set to a single-element array, which will mean that there is no need to change the current object, but property values should be changed for the specified, not the current object. For example, change(setState, {game:{value:[30], hostGoals:40, guestGoals:30}}) will change the number of goals to 40 and 30, but not for the current game, but for one with an object id 30. You can also specify actions in a JS change object (there are no actions in JS state objects). The value of the corresponding field in this case can be arbitrary. For example, change(setState, {game: {doSmthWithGame : true}})</li><li>currentState - a JS object of the current state. Optional parameter. In order to ensure the best UX in the asynchronous mode, it is advised that the user change values only for the objects that he sees during the change and not when the change is processed (the state can change at this moment and so can current objects). Therefore, when calling this function, it is recommended to pass the state that was used to render the view in which the user initiated this change as the currentState parameter.</li></ol></li><li>close - closes the form. Parameters:<ol><li>setState - a state change request function.</li></ol></li><li>formCreated - checks whether the form has been initialized (and, accordingly, whether the state has been filled). Returns a boolean value. Parameters:<ol><li>state - a JS state object</li></ol></li><li>numberOfPendingRequests - show how many change requests are currently queued. Returns a long type value. Parameters:<ol><li>state - a JS state object</li></ol></li></ul><p>As the names of object groups and properties, not names on the form are used, but <a href="/docusaurustest/docs/LSFUS/Structured-view_29884537.html#Structuredview-extid">export/import</a> names (which, however, match the names on forms if not explicitly defined). While working with a form via Form API, actions created using operators for <a href="/docusaurustest/docs/LSFUS/Interactive-view_1573071.html#Interactiveview-objectoperators">object operations</a> <strong>NEW</strong> and <strong>DELETE</strong> automatically get export/import names <strong>NEW</strong> and <strong>DELETE</strong>, respectively (that is you can call change(setState, {game : {NEW:true}} for adding an object, for example) ). Also, when Form API is used, it automatically adds a property called logMessage to the form to which all dialog messages are written (including those generated when <a href="/docusaurustest/docs/LSFUS/lsFusionConstraints">constraints</a> were violated).</p><p>Authentication, stateful and form API are only supported when executing http requests on the web server. When an application server (or specifically, a built-in web server) executes an HTTP request, authentication headers, as well as parameters with the session ID, are ignored (the user is considered anonymous). Form API is completely unsupported by the built-in web server.</p><p><strong>Examples</strong></p><p><em>Rest API (Python)</em></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">import json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import requests</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">from requests_toolbelt.multipart import decoder</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">lsfCode = (&quot;run(INTEGER no, DATE date, FILE detail) {\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;    NEW o = FOrder {\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;        no(o) &lt;- no;\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;        date(o) &lt;- date;\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;        LOCAL detailId = INTEGER (INTEGER);\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;        LOCAL detailQuantity = INTEGER (INTEGER);\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;        IMPORT JSON FROM detail TO detailId, detailQuantity;\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;        FOR imported(INTEGER i) DO {\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;            NEW od = FOrderDetail {\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;                id(od) &lt;- detailId(i);\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;                quantity(od) &lt;- detailQuantity(i);\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;                price(od) &lt;- 5;\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;                order(od) &lt;- o;\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;            }\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;        }\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;        APPLY;\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;        EXPORT JSON FROM price = price(FOrderDetail od), id = id(od) WHERE order(od) == o;\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;        EXPORT FROM orderPrice(o), exportFile();\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;    }\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &quot;}&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">order_no = 354</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">order_date = &#x27;10.10.2017&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">order_details = [dict(id=1, quantity=10),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 dict(id=2, quantity=15),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 dict(id=5, quantity=4),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 dict(id=10, quantity=18),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 dict(id=11, quantity=1),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 dict(id=12, quantity=3)]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">order_json = json.dumps(order_details)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">url = &#x27;http://localhost:7651/eval&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">payload = {&#x27;script&#x27;: lsfCode, &#x27;no&#x27;: str(order_no), &#x27;date&#x27;: order_date,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &#x27;detail&#x27;: (&#x27;order.json&#x27;, order_json, &#x27;text/json&#x27;)}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">response = requests.post(url, files=payload)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">multipart_data = decoder.MultipartDecoder.from_response(response)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sum_part, json_part = multipart_data.parts</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sum = int(sum_part.text)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">data = json.loads(json_part.text)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##############################################################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">print(sum)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">for item in data:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    print(&#x27;{0:3}: price {1}&#x27;.format(int(item[&#x27;id&#x27;]), int(item[&#x27;price&#x27;])))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##############################################################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 205</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#   4: price 5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#  18: price 5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#   3: price 5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#   1: price 5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#  10: price 5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#  15: price 5</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/danchanka/docusaurustest/edit/master/docs/LSFUS/lsFusionAccess_from_an_external_system.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docusaurustest/docs/index">lsf docs</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://ru.stackoverflow.com/questions/tagged/lsfusion" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://slack.lsfusion.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://twitter.com/lsfusion" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docusaurustest/blog">Blog</a></li><li class="footer__item"><a href="https://habr.com/ru/company/lsfusion/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Habr</a></li><li class="footer__item"><a href="https://github.com/danchanka/docusaurustest" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 lsfusion.org. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docusaurustest/styles.484185aa.js"></script>
<script src="/docusaurustest/runtime~main.4775eaa0.js"></script>
<script src="/docusaurustest/main.7eadfc7f.js"></script>
<script src="/docusaurustest/1.15ad1152.js"></script>
<script src="/docusaurustest/2.388c98e9.js"></script>
<script src="/docusaurustest/354.8fc443a5.js"></script>
<script src="/docusaurustest/355.8d0f0209.js"></script>
<script src="/docusaurustest/f976f453.a4a359a4.js"></script>
<script src="/docusaurustest/17896441.e3533d34.js"></script>
<script src="/docusaurustest/64f5043a.b40b6bb6.js"></script>
</body>
</html>